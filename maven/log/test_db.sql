
-- Execute test/Modules/core/Scripts/Pre-db

-- Start of included test/Modules/core/Scripts/procedures_postgres:optional
CREATE OR REPLACE FUNCTION add_column_if_not_exists( tableName VARCHAR, columnName VARCHAR, columnType VARCHAR ) RETURNS BOOLEAN AS '
BEGIN
  BEGIN
    EXECUTE ''ALTER TABLE '' || tableName || '' ADD COLUMN '' || columnName || ''  '' || columnType;
    EXCEPTION
    WHEN duplicate_column
      THEN RETURN 0;
  END;
  RETURN 1;
END;' LANGUAGE 'plpgsql';
CREATE OR REPLACE FUNCTION drop_if_exists_column( tableName VARCHAR, columnName VARCHAR ) RETURNS BOOLEAN AS '
BEGIN
  BEGIN
    EXECUTE ''ALTER TABLE '' || tableName || '' DROP COLUMN '' || columnName;
    EXCEPTION
    WHEN undefined_column
      THEN RETURN 0;
  END;
  RETURN 1;
END;' LANGUAGE 'plpgsql';
-- End of included test/Modules/core/Scripts/procedures_postgres:optional
DROP TABLE IF EXISTS categories;
CREATE TABLE categories ( id BIGSERIAL PRIMARY KEY, entity VARCHAR(30) NOT NULL, publicid VARCHAR(100), name TEXT NOT NULL, parentid BIGINT, description TEXT);
CREATE INDEX idx_cat_entity_par ON categories(entity, parentid);
CREATE INDEX idx_cat_entity_pub ON categories(entity, publicid);
CREATE INDEX idx_cat_name_par ON categories(name, parentid);
CREATE INDEX idx_cat_parent_id ON categories(parentid);
CREATE INDEX idx_cat_publicid ON categories(publicid);
DROP TABLE IF EXISTS classifications;
CREATE TABLE classifications ( id BIGSERIAL PRIMARY KEY, recordid VARCHAR(200) NOT NULL, categoryid BIGINT NOT NULL, whoinserted___ VARCHAR(100), creationdate___ TIMESTAMP);
CREATE INDEX idx_classif1 ON classifications(recordid, categoryid);
CREATE INDEX idx_classif2 ON classifications(categoryid, recordid);
DROP TABLE IF EXISTS icons;
CREATE TABLE icons ( id BIGSERIAL PRIMARY KEY, ownerid VARCHAR(50) NOT NULL, name VARCHAR(100) NOT NULL, mimetype VARCHAR(11) DEFAULT 'image/gif' CHECK(mimetype IN ('image/gif', 'image/jpeg', 'image/pjpeg', 'image/png') ) NOT NULL, data BYTEA NOT NULL, origin VARCHAR(255) DEFAULT 'application');
CREATE UNIQUE INDEX i_u_icons_oid ON icons(ownerid);
DROP TABLE IF EXISTS languages;
CREATE TABLE languages ( id CHAR(2) NOT NULL PRIMARY KEY, name VARCHAR(30) NOT NULL);
DROP TABLE IF EXISTS mimetypes;
CREATE TABLE mimetypes ( type VARCHAR(50) NOT NULL PRIMARY KEY, name VARCHAR(100));
DROP TABLE IF EXISTS sequences;
CREATE TABLE sequences ( section VARCHAR(50) NOT NULL, name VARCHAR(50) NOT NULL, counter BIGINT NOT NULL);
CREATE UNIQUE INDEX idx_sequences_sn ON sequences(section, name);
DROP TABLE IF EXISTS systemsettings;
CREATE TABLE systemsettings ( section_name VARCHAR(255) DEFAULT 'system' NOT NULL, setting_name VARCHAR(64) NOT NULL, setting_value TEXT NOT NULL);
CREATE UNIQUE INDEX i_ue_ss_sn_sn ON systemsettings(section_name, setting_name);
DROP TABLE IF EXISTS table_refs;
CREATE TABLE table_refs ( tablefrom VARCHAR(30) NOT NULL, columnsfrom VARCHAR(60) NOT NULL, tableto VARCHAR(30), columnsto VARCHAR(60), selectionviewid BIGINT);
CREATE UNIQUE INDEX trefs_tf_cf ON table_refs(tablefrom, columnsfrom, tableto);

-- Execute test/Modules/core/Scripts/Post-db

-- Start of included test/Modules/core/Scripts/dictionaries

-- Start of included test/Modules/core/Scripts/dict/languages
DELETE FROM languages;
INSERT INTO languages( ID, name ) VALUES( 'aa', 'Afar' );
INSERT INTO languages( ID, name ) VALUES( 'ab', 'Abkhazian' );
INSERT INTO languages( ID, name ) VALUES( 'af', 'Afrikaans' );
INSERT INTO languages( ID, name ) VALUES( 'am', 'Amharic' );
INSERT INTO languages( ID, name ) VALUES( 'ar', 'Arabic' );
INSERT INTO languages( ID, name ) VALUES( 'as', 'Assamese' );
INSERT INTO languages( ID, name ) VALUES( 'ay', 'Aymara' );
INSERT INTO languages( ID, name ) VALUES( 'az', 'Azerbaijani' );
INSERT INTO languages( ID, name ) VALUES( 'ba', 'Bashkir' );
INSERT INTO languages( ID, name ) VALUES( 'be', 'Byelorussian' );
INSERT INTO languages( ID, name ) VALUES( 'bg', 'Bulgarian' );
INSERT INTO languages( ID, name ) VALUES( 'bh', 'Bihari' );
INSERT INTO languages( ID, name ) VALUES( 'bi', 'Bislama' );
INSERT INTO languages( ID, name ) VALUES( 'bn', 'Bengali; Bangla' );
INSERT INTO languages( ID, name ) VALUES( 'bo', 'Tibetan' );
INSERT INTO languages( ID, name ) VALUES( 'br', 'Breton' );
INSERT INTO languages( ID, name ) VALUES( 'ca', 'Catalan' );
INSERT INTO languages( ID, name ) VALUES( 'co', 'Corsican' );
INSERT INTO languages( ID, name ) VALUES( 'cs', 'Czech' );
INSERT INTO languages( ID, name ) VALUES( 'cy', 'Welsh' );
INSERT INTO languages( ID, name ) VALUES( 'da', 'Danish' );
INSERT INTO languages( ID, name ) VALUES( 'de', 'German' );
INSERT INTO languages( ID, name ) VALUES( 'dz', 'Bhutani' );
INSERT INTO languages( ID, name ) VALUES( 'el', 'Greek' );
INSERT INTO languages( ID, name ) VALUES( 'en', 'English' );
INSERT INTO languages( ID, name ) VALUES( 'eo', 'Esperanto' );
INSERT INTO languages( ID, name ) VALUES( 'es', 'Spanish' );
INSERT INTO languages( ID, name ) VALUES( 'et', 'Estonian' );
INSERT INTO languages( ID, name ) VALUES( 'eu', 'Basque' );
INSERT INTO languages( ID, name ) VALUES( 'fa', 'Persian' );
INSERT INTO languages( ID, name ) VALUES( 'fi', 'Finnish' );
INSERT INTO languages( ID, name ) VALUES( 'fj', 'Fiji' );
INSERT INTO languages( ID, name ) VALUES( 'fo', 'Faroese' );
INSERT INTO languages( ID, name ) VALUES( 'fr', 'French' );
INSERT INTO languages( ID, name ) VALUES( 'fy', 'Frisian' );
INSERT INTO languages( ID, name ) VALUES( 'ga', 'Irish' );
INSERT INTO languages( ID, name ) VALUES( 'gd', 'Scots Gaelic' );
INSERT INTO languages( ID, name ) VALUES( 'gl', 'Galician' );
INSERT INTO languages( ID, name ) VALUES( 'gn', 'Guarani' );
INSERT INTO languages( ID, name ) VALUES( 'gu', 'Gujarati' );
INSERT INTO languages( ID, name ) VALUES( 'ha', 'Hausa' );
INSERT INTO languages( ID, name ) VALUES( 'he', 'Hebrew' );
INSERT INTO languages( ID, name ) VALUES( 'hi', 'Hindi' );
INSERT INTO languages( ID, name ) VALUES( 'hr', 'Croatian' );
INSERT INTO languages( ID, name ) VALUES( 'hu', 'Hungarian' );
INSERT INTO languages( ID, name ) VALUES( 'hy', 'Armenian' );
INSERT INTO languages( ID, name ) VALUES( 'ia', 'Interlingua' );
INSERT INTO languages( ID, name ) VALUES( 'id', 'Indonesian' );
INSERT INTO languages( ID, name ) VALUES( 'ie', 'Interlingue' );
INSERT INTO languages( ID, name ) VALUES( 'ik', 'Inupiak' );
INSERT INTO languages( ID, name ) VALUES( 'is', 'Icelandic' );
INSERT INTO languages( ID, name ) VALUES( 'it', 'Italian' );
INSERT INTO languages( ID, name ) VALUES( 'iu', 'Inuktitut' );
INSERT INTO languages( ID, name ) VALUES( 'ja', 'Japanese' );
INSERT INTO languages( ID, name ) VALUES( 'jw', 'Javanese' );
INSERT INTO languages( ID, name ) VALUES( 'ka', 'Georgian' );
INSERT INTO languages( ID, name ) VALUES( 'kk', 'Kazakh' );
INSERT INTO languages( ID, name ) VALUES( 'kl', 'Greenlandic' );
INSERT INTO languages( ID, name ) VALUES( 'km', 'Cambodian' );
INSERT INTO languages( ID, name ) VALUES( 'kn', 'Kannada' );
INSERT INTO languages( ID, name ) VALUES( 'ko', 'Korean' );
INSERT INTO languages( ID, name ) VALUES( 'ks', 'Kashmiri' );
INSERT INTO languages( ID, name ) VALUES( 'ku', 'Kurdish' );
INSERT INTO languages( ID, name ) VALUES( 'ky', 'Kirghiz' );
INSERT INTO languages( ID, name ) VALUES( 'la', 'Latin' );
INSERT INTO languages( ID, name ) VALUES( 'ln', 'Lingala' );
INSERT INTO languages( ID, name ) VALUES( 'lo', 'Laothian' );
INSERT INTO languages( ID, name ) VALUES( 'lt', 'Lithuanian' );
INSERT INTO languages( ID, name ) VALUES( 'lv', 'Latvian, Lettish' );
INSERT INTO languages( ID, name ) VALUES( 'mg', 'Malagasy' );
INSERT INTO languages( ID, name ) VALUES( 'mi', 'Maori' );
INSERT INTO languages( ID, name ) VALUES( 'mk', 'Macedonian' );
INSERT INTO languages( ID, name ) VALUES( 'ml', 'Malayalam' );
INSERT INTO languages( ID, name ) VALUES( 'mn', 'Mongolian' );
INSERT INTO languages( ID, name ) VALUES( 'mo', 'Moldavian' );
INSERT INTO languages( ID, name ) VALUES( 'mr', 'Marathi' );
INSERT INTO languages( ID, name ) VALUES( 'ms', 'Malay' );
INSERT INTO languages( ID, name ) VALUES( 'mt', 'Maltese' );
INSERT INTO languages( ID, name ) VALUES( 'my', 'Burmese' );
INSERT INTO languages( ID, name ) VALUES( 'na', 'Nauru' );
INSERT INTO languages( ID, name ) VALUES( 'ne', 'Nepali' );
INSERT INTO languages( ID, name ) VALUES( 'nl', 'Dutch' );
INSERT INTO languages( ID, name ) VALUES( 'no', 'Norwegian' );
INSERT INTO languages( ID, name ) VALUES( 'oc', 'Occitan' );
INSERT INTO languages( ID, name ) VALUES( 'om', '(Afan) Oromo' );
INSERT INTO languages( ID, name ) VALUES( 'or', 'Oriya' );
INSERT INTO languages( ID, name ) VALUES( 'pa', 'Punjabi' );
INSERT INTO languages( ID, name ) VALUES( 'pl', 'Polish' );
INSERT INTO languages( ID, name ) VALUES( 'ps', 'Pashto, Pushto' );
INSERT INTO languages( ID, name ) VALUES( 'pt', 'Portuguese' );
INSERT INTO languages( ID, name ) VALUES( 'qu', 'Quechua' );
INSERT INTO languages( ID, name ) VALUES( 'rm', 'Rhaeto-Romance' );
INSERT INTO languages( ID, name ) VALUES( 'rn', 'Kirundi' );
INSERT INTO languages( ID, name ) VALUES( 'ro', 'Romanian' );
INSERT INTO languages( ID, name ) VALUES( 'ru', 'Russian' );
INSERT INTO languages( ID, name ) VALUES( 'rw', 'Kinyarwanda' );
INSERT INTO languages( ID, name ) VALUES( 'sa', 'Sanskrit' );
INSERT INTO languages( ID, name ) VALUES( 'sd', 'Sindhi' );
INSERT INTO languages( ID, name ) VALUES( 'sg', 'Sangho' );
INSERT INTO languages( ID, name ) VALUES( 'sh', 'Serbo-Croatian' );
INSERT INTO languages( ID, name ) VALUES( 'si', 'Sinhalese' );
INSERT INTO languages( ID, name ) VALUES( 'sk', 'Slovak' );
INSERT INTO languages( ID, name ) VALUES( 'sl', 'Slovenian' );
INSERT INTO languages( ID, name ) VALUES( 'sm', 'Samoan' );
INSERT INTO languages( ID, name ) VALUES( 'sn', 'Shona' );
INSERT INTO languages( ID, name ) VALUES( 'so', 'Somali' );
INSERT INTO languages( ID, name ) VALUES( 'sq', 'Albanian' );
INSERT INTO languages( ID, name ) VALUES( 'sr', 'Serbian' );
INSERT INTO languages( ID, name ) VALUES( 'ss', 'Siswati' );
INSERT INTO languages( ID, name ) VALUES( 'st', 'Sesotho' );
INSERT INTO languages( ID, name ) VALUES( 'su', 'Sundanese' );
INSERT INTO languages( ID, name ) VALUES( 'sv', 'Swedish' );
INSERT INTO languages( ID, name ) VALUES( 'sw', 'Swahili' );
INSERT INTO languages( ID, name ) VALUES( 'ta', 'Tamil' );
INSERT INTO languages( ID, name ) VALUES( 'te', 'Telugu' );
INSERT INTO languages( ID, name ) VALUES( 'tg', 'Tajik' );
INSERT INTO languages( ID, name ) VALUES( 'th', 'Thai' );
INSERT INTO languages( ID, name ) VALUES( 'ti', 'Tigrinya' );
INSERT INTO languages( ID, name ) VALUES( 'tk', 'Turkmen' );
INSERT INTO languages( ID, name ) VALUES( 'tl', 'Tagalog' );
INSERT INTO languages( ID, name ) VALUES( 'tn', 'Setswana' );
INSERT INTO languages( ID, name ) VALUES( 'to', 'Tonga' );
INSERT INTO languages( ID, name ) VALUES( 'tr', 'Turkish' );
INSERT INTO languages( ID, name ) VALUES( 'ts', 'Tsonga' );
INSERT INTO languages( ID, name ) VALUES( 'tt', 'Tatar' );
INSERT INTO languages( ID, name ) VALUES( 'tw', 'Twi' );
INSERT INTO languages( ID, name ) VALUES( 'ug', 'Uighur' );
INSERT INTO languages( ID, name ) VALUES( 'uk', 'Ukrainian' );
INSERT INTO languages( ID, name ) VALUES( 'ur', 'Urdu' );
INSERT INTO languages( ID, name ) VALUES( 'uz', 'Uzbek' );
INSERT INTO languages( ID, name ) VALUES( 'vi', 'Vietnamese' );
INSERT INTO languages( ID, name ) VALUES( 'vo', 'Volapuk' );
INSERT INTO languages( ID, name ) VALUES( 'wo', 'Wolof' );
INSERT INTO languages( ID, name ) VALUES( 'xh', 'Xhosa' );
INSERT INTO languages( ID, name ) VALUES( 'yi', 'Yiddish (formerly ji)' );
INSERT INTO languages( ID, name ) VALUES( 'yo', 'Yoruba' );
INSERT INTO languages( ID, name ) VALUES( 'za', 'Zhuang' );
INSERT INTO languages( ID, name ) VALUES( 'zh', 'Chinese' );
INSERT INTO languages( ID, name ) VALUES( 'zu', 'Zulu' );
-- End of included test/Modules/core/Scripts/dict/languages

-- Start of included test/Modules/core/Scripts/dict/mimeTypes
DELETE FROM mimeTypes;
INSERT INTO mimeTypes VALUES( 'application/xml', null );
INSERT INTO mimeTypes VALUES( 'application/x-zip-compressed', null );
INSERT INTO mimeTypes VALUES( 'application/x-msdownload', null );
INSERT INTO mimeTypes VALUES( 'application/x-java', null );
INSERT INTO mimeTypes VALUES( 'application/x-javascript', null );
INSERT INTO mimeTypes VALUES( 'message/rfc822', null );
INSERT INTO mimeTypes VALUES( 'text/x-vcard', null );
INSERT INTO mimeTypes VALUES( 'application/java-archive', null );
INSERT INTO mimeTypes VALUES( 'application/java', null );
INSERT INTO mimeTypes VALUES( 'application/mac-binhex40', null );
INSERT INTO mimeTypes VALUES( 'application/msword', null );
INSERT INTO mimeTypes VALUES( 'application/octet-stream', null );
INSERT INTO mimeTypes VALUES( 'application/oda', null );
INSERT INTO mimeTypes VALUES( 'application/pdf', null );
INSERT INTO mimeTypes VALUES( 'application/postscript', null );
INSERT INTO mimeTypes VALUES( 'application/rtf', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.ms-excel', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.ms-powerpoint', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.rim.cod', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.rn-realmedia', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.wap.wmlc', null );
INSERT INTO mimeTypes VALUES( 'application/vnd.wap.wmlscriptc', null );
INSERT INTO mimeTypes VALUES( 'application/x-aim', null );
INSERT INTO mimeTypes VALUES( 'application/x-bcpio', null );
INSERT INTO mimeTypes VALUES( 'application/x-cdf', null );
INSERT INTO mimeTypes VALUES( 'application/x-compress', null );
INSERT INTO mimeTypes VALUES( 'application/x-cpio', null );
INSERT INTO mimeTypes VALUES( 'application/x-csh', null );
INSERT INTO mimeTypes VALUES( 'application/x-dvi', null );
INSERT INTO mimeTypes VALUES( 'application/x-gtar', null );
INSERT INTO mimeTypes VALUES( 'application/x-gzip', null );
INSERT INTO mimeTypes VALUES( 'application/x-hdf', null );
INSERT INTO mimeTypes VALUES( 'application/x-java-jnlp-file', null );
INSERT INTO mimeTypes VALUES( 'application/x-latex', null );
INSERT INTO mimeTypes VALUES( 'application/x-mif', null );
INSERT INTO mimeTypes VALUES( 'application/x-netcdf', null );
INSERT INTO mimeTypes VALUES( 'application/x-shar', null );
INSERT INTO mimeTypes VALUES( 'application/x-sh', null );
INSERT INTO mimeTypes VALUES( 'application/x-shockwave-flash', null );
INSERT INTO mimeTypes VALUES( 'application/x-sv4cpio', null );
INSERT INTO mimeTypes VALUES( 'application/x-sv4crc', null );
INSERT INTO mimeTypes VALUES( 'application/x-tar', null );
INSERT INTO mimeTypes VALUES( 'application/x-tcl', null );
INSERT INTO mimeTypes VALUES( 'application/x-texinfo', null );
INSERT INTO mimeTypes VALUES( 'application/x-tex', null );
INSERT INTO mimeTypes VALUES( 'application/x-troff-man', null );
INSERT INTO mimeTypes VALUES( 'application/x-troff-me', null );
INSERT INTO mimeTypes VALUES( 'application/x-troff', null );
INSERT INTO mimeTypes VALUES( 'application/x-ustar', null );
INSERT INTO mimeTypes VALUES( 'application/x-wais-source', null );
INSERT INTO mimeTypes VALUES( 'application/x-x509-ca-cert', null );
INSERT INTO mimeTypes VALUES( 'application/zip', null );
INSERT INTO mimeTypes VALUES( 'audio/basic', null );
INSERT INTO mimeTypes VALUES( 'audio/x-aiff', null );
INSERT INTO mimeTypes VALUES( 'audio/x-midi', null );
INSERT INTO mimeTypes VALUES( 'audio/x-mpeg', null );
INSERT INTO mimeTypes VALUES( 'audio/x-mpegurl', null );
INSERT INTO mimeTypes VALUES( 'audio/x-scpls', null );
INSERT INTO mimeTypes VALUES( 'audio/x-wav', null );
INSERT INTO mimeTypes VALUES( 'image/bmp', null );
INSERT INTO mimeTypes VALUES( 'image/gif', null );
INSERT INTO mimeTypes VALUES( 'image/ief', null );
INSERT INTO mimeTypes VALUES( 'image/jpeg', null );
INSERT INTO mimeTypes VALUES( 'image/pjpeg', null );
INSERT INTO mimeTypes VALUES( 'image/pict', null );
INSERT INTO mimeTypes VALUES( 'image/png', null );
INSERT INTO mimeTypes VALUES( 'image/tiff', null );
INSERT INTO mimeTypes VALUES( 'image/vnd.wap.wbmp', null );
INSERT INTO mimeTypes VALUES( 'image/x-cmu-raster', null );
INSERT INTO mimeTypes VALUES( 'image/x-jg', null );
INSERT INTO mimeTypes VALUES( 'image/x-macpaint', null );
INSERT INTO mimeTypes VALUES( 'image/x-photoshop', null );
INSERT INTO mimeTypes VALUES( 'image/x-portable-anymap', null );
INSERT INTO mimeTypes VALUES( 'image/x-portable-bitmap', null );
INSERT INTO mimeTypes VALUES( 'image/x-portable-graymap', null );
INSERT INTO mimeTypes VALUES( 'image/x-portable-pixmap', null );
INSERT INTO mimeTypes VALUES( 'image/x-quicktime', null );
INSERT INTO mimeTypes VALUES( 'image/x-rgb', null );
INSERT INTO mimeTypes VALUES( 'image/x-xbitmap', null );
INSERT INTO mimeTypes VALUES( 'image/x-xpixmap', null );
INSERT INTO mimeTypes VALUES( 'image/x-xwindowdump', null );
INSERT INTO mimeTypes VALUES( 'text/css', null );
INSERT INTO mimeTypes VALUES( 'text/html', null );
INSERT INTO mimeTypes VALUES( 'text/javascript', null );
INSERT INTO mimeTypes VALUES( 'text/plain', null );
INSERT INTO mimeTypes VALUES( 'text/richtext', null );
INSERT INTO mimeTypes VALUES( 'text/tab-separated-values', null );
INSERT INTO mimeTypes VALUES( 'text/vnd.sun.j2me.app-descriptor', null );
INSERT INTO mimeTypes VALUES( 'text/vnd.wap.wml', null );
INSERT INTO mimeTypes VALUES( 'text/vnd.wap.wmls', null );
INSERT INTO mimeTypes VALUES( 'text/x-setext', null );
INSERT INTO mimeTypes VALUES( 'video/mpeg2', null );
INSERT INTO mimeTypes VALUES( 'video/mpeg', null );
INSERT INTO mimeTypes VALUES( 'video/quicktime', null );
INSERT INTO mimeTypes VALUES( 'video/x-dv', null );
INSERT INTO mimeTypes VALUES( 'video/x-ms-asf', null );
INSERT INTO mimeTypes VALUES( 'video/x-msvideo', null );
INSERT INTO mimeTypes VALUES( 'video/x-rad-screenplay', null );
INSERT INTO mimeTypes VALUES( 'video/x-sgi-movie', null );
INSERT INTO mimeTypes VALUES( 'x-world/x-vrml', null );
-- End of included test/Modules/core/Scripts/dict/mimeTypes
-- End of included test/Modules/core/Scripts/dictionaries
DROP TABLE IF EXISTS testtable;
CREATE TABLE testtable ( id BIGSERIAL PRIMARY KEY, name VARCHAR(20) NOT NULL, value VARCHAR(30) NOT NULL);
